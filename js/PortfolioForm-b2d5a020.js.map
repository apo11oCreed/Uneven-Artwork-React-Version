{"version":3,"file":"PortfolioForm-b2d5a020.js","sources":["../../src/features/portfolio/PortfolioContainer.jsx","../../src/app/routes/portfolio/PortfolioForm.jsx"],"sourcesContent":["import React, { Suspense } from 'react';\nimport Loader from '../../app/components/common/Loader';\nconst Artwork = React.lazy(()=>import('./Portfolio'));\n\nexport default function ArtworkContainer({ imageCollection }) {\n\n\treturn (\n\t\t\t<ul className='tw-flex tw-flex-wrap tw-justify-between'>\n\t\t\t\t{imageCollection.map((item, index) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Suspense\n\t\t\t\t\t\t\tfallback={<Loader />} key={index}>\n\t\t\t\t\t\t\t<Artwork item={item} index={index} />\n\t\t\t\t\t\t</Suspense>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</ul>\n\t);\n}\n","import React, { useState, useEffect, useRef } from 'react';\nimport ArtworkContainer from '../../../features/portfolio/PortfolioContainer';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { filterImages } from '../../../app/store/slices/portfolioSlice';\n\nexport default function PortfolioForm() {\n\tconst imagesSelector = useSelector((state) => state.portfolio.images);\n\tconst dispatch = useDispatch();\n\n\tconst filterSelector = useRef();\n\tconst portfolioTitle = useRef();\n\n\tconst contentful = import.meta.env;\n\tconst spaceId = contentful.VITE_CONTENTFUL_SPACE_ID;\n\tconst accessToken = contentful.VITE_CONTENTFUL_DELIVERY_API_ACCESS_TOKEN;\n\tconst query = `\n\tquery imagesAssets {\n\t\timageCollection{\n\t\t\titems{\n\t\t\t\timage{\n\t\t\t\t\ttitle\n\t\t\t\t\tdescription\n\t\t\t\t\turl\n\t\t\t\t\tcontentfulMetadata{\n\t\t\t\t\t\ttags{\n\t\t\t\t\t\t\tname\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tassetCollection(where:{\n\t\t\tcontentfulMetadata:{\n\t\t\t  tags_exists:true\n\t\t\t}\n\t\t  }){\n\t\t\titems{\n\t\t\t\tcontentfulMetadata{\n\t\t\t\t\ttags{\n\t\t\t\t\t\tname\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t`;\n\n\tconst [tagFilter, setTagFilter] = useState([]);\n\tconst [isLoading, setIsLoading] = useState(true);\n\n\tlet imagesQuery = [],\n\t\tassetsQuery = [];\n\n\tuseEffect(() => {\n\t\twindow.fetch(`https://graphql.contentful.com/content/v1/spaces/${spaceId}/environments/master`, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'content-type': 'application/json',\n\t\t\t\tAuthorization: `Bearer ${accessToken}`,\n\t\t\t},\n\t\t\tbody: JSON.stringify({\n\t\t\t\tquery,\n\t\t\t}),\n\t\t})\n\t\t\t.then((res) => res.json())\n\t\t\t.then(({ data, errors }) => {\n\t\t\t\tif (errors) {\n\t\t\t\t\tconsole.error(errors);\n\t\t\t\t}\n\n\t\t\t\timagesQuery = data.imageCollection.items;\n\t\t\t\tconst imageUrls = imagesQuery.map((item) => {\n\t\t\t\t\treturn item.image.url;\n\t\t\t\t});\n\n\t\t\t\tassetsQuery = data.assetCollection.items;\n\t\t\t\tconst tags = assetsQuery.map((item) => {\n\t\t\t\t\treturn item.contentfulMetadata.tags[0].name;\n\t\t\t\t});\n\n\t\t\t\t// Update images data array in redux store\n\t\t\t\tdispatch(filterImages(imagesQuery));\n\n\t\t\t\t// Initial filter options\n\t\t\t\tsetTagFilter([...new Set(tags)]);\n\n\t\t\t\t// Precache images\n\t\t\t\tcacheImages(imageUrls, setIsLoading);\n\n\t\t\t});\n\n\t\tif (filterSelector && filterSelector.current) {\n\t\t\tfilterSelector.current.addEventListener('change', filter);\n\t\t} else {\n\t\t\tfilterSelector.current.removeEventListener('change', filter);\n\t\t}\n\t}, []);\n\n\tconst cacheImages = async (imgArray, set) => {\n\t\tconst promises = await imgArray.map((src) => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tconst img = new Image();\n\n\t\t\t\timg.src = src;\n\t\t\t\timg.onload = resolve();\n\t\t\t\timg.onerror = reject();\n\t\t\t});\n\t\t});\n\n\t\tawait Promise.all(promises);\n\n\t\tset(false);\n\t};\n\n\t// filterSelector should be converted to feature and added to Store to render based on the state of the Select drop down\n\n\tconst filter = (e) => {\n\t\tlet filteredArray = [];\n\n\t\tif (e.target.value == 'all') {\n\t\t\tfilteredArray = imagesQuery;\n\t\t} else {\n\t\t\tfilteredArray = imagesQuery.filter((item) => {\n\t\t\t\treturn item.image.contentfulMetadata.tags[0].name == e.target.value;\n\t\t\t});\n\t\t}\n\n\t\tportfolioTitle.current.innerHTML = `${e.target.value} Samples`;\n\n\t\t// build dispatch action\n\t\tdispatch(filterImages(filteredArray));\n\t};\n\n\treturn (\n\t\t<section className='portfolio'>\n\t\t\t<form>\n\t\t\t\t<legend>\n\t\t\t\t\t<h2 ref={portfolioTitle} className='tw-font-bold tw-capitalize tw-text-center tw-mb-[2rem]'>\n\t\t\t\t\t\tAll Samples\n\t\t\t\t\t</h2>\n\t\t\t\t</legend>\n\t\t\t\t<label htmlFor='tagName'>Select Category</label>\n\t\t\t\t<select name='tag' ref={filterSelector}>\n\t\t\t\t\t<option value='all'>All</option>\n\t\t\t\t\t{tagFilter.map((tag, index) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<option value={tag} key={index}>\n\t\t\t\t\t\t\t\t{tag}\n\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</select>\n\t\t\t</form>\n\t\t\t<ArtworkContainer imageCollection={imagesSelector} />\n\t\t</section>\n\t);\n}\n"],"names":["Artwork","React","lazy","imageCollection","map","item","index","Suspense","_jsx","imagesSelector","useSelector","state","portfolio","images","dispatch","useDispatch","filterSelector","useRef","portfolioTitle","contentful","import","spaceId","VITE_CONTENTFUL_SPACE_ID","accessToken","VITE_CONTENTFUL_DELIVERY_API_ACCESS_TOKEN","query","tagFilter","setTagFilter","useState","isLoading","setIsLoading","imagesQuery","assetsQuery","useEffect","fetch","method","headers","Authorization","body","JSON","stringify","then","res","json","data","errors","console","error","items","imageUrls","image","url","assetCollection","tags","contentfulMetadata","name","filterImages","Set","cacheImages","current","addEventListener","filter","removeEventListener","imgArray","set","promises","src","Promise","resolve","reject","img","Image","onload","onerror","all","e","filteredArray","target","value","innerHTML","_jsxs","tag"],"mappings":"qKAEA,KAAMA,GAAUC,EAAMC,KAAK,IAAI,EAAA,IAAA,OAAA,2BAAA,kBAAA,CAAf,EAEyB,WAAA,CAAEC,mBAAmB,CAG3D,SAAA,KAAA,CAAI,UAAU,0CACZA,SAAAA,EAAgBC,IAAI,CAACC,EAAMC,MAEzBC,EAAAA,QAAAA,SAAD,CACC,SAAUC,EAAC,EADZ,EAAA,EAAA,WAEE,EAAD,CAAS,OAAY,OAAA,CAArB,GAD2BF,CAD5B,CAFD,CAAA,CAFJ,CAYA,CCbuC,YAAA,CACjCG,KAAAA,GAAiBC,EAAaC,AAAUA,GAAAA,EAAMC,UAAUC,MAA5B,EAC5BC,EAAWC,IAEXC,EAAiBC,EAAAA,QAAAA,SACjBC,EAAiBD,EAAAA,QAAAA,SAEjBE,EAAaC,CAAAA,yBAAAA,eAAAA,0CAAAA,8CAAAA,SAAAA,IAAAA,KAAAA,aAAAA,IAAAA,GAAAA,KAAAA,EAAAA,EACbC,EAAUF,EAAWG,yBACrBC,EAAcJ,EAAWK,0CACzBC,EAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAgCT,CAACC,EAAWC,GAAgBC,EAAAA,QAAAA,SAAS,CAAD,CAAA,EACpC,CAACC,EAAWC,GAAgBF,EAAAA,QAAAA,SAAS,EAAD,EAEtCG,GAAAA,GAAc,CAAA,EACjBC,EAAc,GAEfC,EAAAA,QAAAA,UAAU,IAAM,CACRC,OAAAA,MAAO,oDAAmDb,wBAA+B,CAC/Fc,OAAQ,OACRC,QAAS,CACR,eAAgB,mBAChBC,cAAgB,UAASd,GAJqE,EAM/Fe,KAAMC,KAAKC,UAAU,CACpBf,OAAAA,CADK,CAAA,CANP,EAUEgB,KAAMC,AAAAA,GAAQA,EAAIC,KAVpB,CAAA,EAWEF,KAAK,CAAC,CAAEG,OAAMC,YAAa,CAC3B,AAAIA,GACHC,QAAQC,MAAMF,CAAd,EAGDd,EAAca,EAAKzC,gBAAgB6C,MAC7BC,KAAAA,GAAYlB,EAAY3B,IAAKC,AAAS,GACpCA,EAAK6C,MAAMC,GADD,EAIlBnB,EAAcY,EAAKQ,gBAAgBJ,MAC7BK,KAAAA,GAAOrB,EAAY5B,IAAKC,AAAS,GAC/BA,EAAKiD,mBAAmBD,KAAK,GAAGE,IAD3B,EAKJC,EAAAA,EAAazB,CAAD,CAAb,EAGRJ,EAAa,CAAC,GAAG,GAAI8B,KAAIJ,CAAR,CAAJ,CAAD,EAGZK,EAAYT,EAAWnB,CAAZ,CAAA,CAjCb,EAqCId,AAAAA,GAAkBA,EAAe2C,QACrBA,EAAAA,QAAQC,iBAAiB,SAAUC,CAAlD,EAEeF,EAAAA,QAAQG,oBAAoB,SAAUD,CAArD,CAzCO,EA2CN,CA3CM,CAAA,EA6CHH,KAAAA,GAAc,MAAOK,EAAUC,IAAQ,CACtCC,KAAAA,GAAW,KAAMF,GAAS3D,IAAK8D,AAAQ,GACrC,GAAIC,SAAQ,CAACC,EAASC,IAAW,CACjCC,KAAAA,GAAM,GAAIC,OAEhBD,EAAIJ,IAAMA,EACVI,EAAIE,OAASJ,IACbE,EAAIG,QAAUJ,GAAd,CALM,CADe,EAUjBF,KAAAA,SAAQO,IAAIT,CAAZ,EAEND,EAAI,EAAD,CAAA,EAKEH,EAAUc,AAAM,GAAA,CACjBC,GAAAA,GAAgB,CAAA,EAEhBD,AAAAA,EAAEE,OAAOC,OAAS,MACL/C,EAAAA,EAEAA,EAAAA,EAAY8B,OAAQxD,AAAS,GACrCA,EAAK6C,MAAMI,mBAAmBD,KAAK,GAAGE,MAAQoB,EAAEE,OAAOC,KAD/C,EAKjB5D,EAAeyC,QAAQoB,UAAa,GAAEJ,EAAEE,OAAOC,gBAGtCtB,EAAAA,EAAaoB,CAAD,CAAb,CAAA,EAIR,SAAA,UAAA,CAAS,UAAU,YAClB,SAAA,CAAAI,EAAA,OAAA,CACC,SAAA,CAAAxE,EAAA,SAAA,CACC,WAAA,KAAA,CAAI,IAAKU,EAAgB,UAAU,yDAAnC,SAAA,aAAA,CAAA,CAAA,CADD,EAKAV,EAAA,QAAA,CAAO,QAAQ,UAAf,SAAA,iBAAA,CAAA,EACAwE,EAAA,SAAA,CAAQ,KAAK,MAAM,IAAKhE,EACvB,SAAA,CAAAR,EAAA,SAAA,CAAQ,MAAM,MAAd,SAAA,KADD,CAAA,EAEEkB,EAAUtB,IAAI,CAAC6E,EAAK3E,MAEnB,SAAA,CAAQ,MAAO2E,EACbA,SAAAA,GADuB3E,CAAzB,CAFD,CAFF,CAAA,CAPD,CAAA,CAAA,CADD,EAmBCE,EAAC,EAAD,CAAkB,gBAAiBC,CAAAA,CAnBpC,CAAA,CAAA,CADD,CAuBA"}